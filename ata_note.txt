Porting my former changes to new repo and on my own branch
